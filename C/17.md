# 17. 변수의 생존 조건 및 데이터 세그먼트의 구조

## 지역 변수(local variable)

중괄호(`{}`)는 하나의 지역으로 취급되며, 그 지역에서 정의된 변수는 바깥 지역에서 접근 할 수 없다.

이렇게 해당 지역에서만 접근할 수 있다고 해서 위와 같은 변수들을 지역 변수라고 한다.

지역 변수는 지역이 종료 될때 사라진다.

## 전역 변수(global variable)

지역 변수와 달리 코드 어느 곳에서도 접근 할 수 있다.

```c
#include <stdio.h>

int global;

int function() {
  global++;
  return 0;
}

int main() {
  function();
  printf("%d \n", global);
  return 0;
}
```

전역 변수는 프로그램이 종료 될 때 사라진다.

또한, 지역 변수와 달리 메모리의 데이터 영역(Data segment)에 할당 됩니다.

모든 전역변수들은 정의시 자동으로 0으로 초기화된다.

> [!WARNING]
> 전역 변수는 모든 함수에서 접근 할 수 있기 때문에 사용시 주의하고 많은 수의 전역 변수를 선언하지 않도록 한다.


## 변수의 생존 기간

일반적으로 정의된 변수들은 자신이 정의된 지역을 빠져나갈 때 파괴됨.

## 정적 변수(static variable)

지역을 빠져나가도 파괴되지 않는 변수.

정적 변수는 딱 한 번만 초기화 됨(ex. `function()`를 여러번 실행해도 `static int a = 2;`는 한번만 실행됨)

정적변수는 굳이 정의 하지 않아도 이미 정의 되어 있음.(ex. `function()`을 실행 하지 않더라도 a라는 정적 변수는 이미 정의 되어 있음)

```c
#include <stdio.h>

int* function() {
  static int a = 2;
  return &a;
}

int main() {
  int *pa = function();
  printf("%d \n", *pa);
}
```

## 데이터 세그먼트의 구조

프로그램이 실행 될 때 프로그램의 모든 내용(코드, 데이터)은 RAM에 올라옴.

|코드 세그먼트(Code Segment)|데이터 세그먼트(Data Segment)|
|-|-|
|코드 영역|스택(Stack), 힙(Heap), 데이터 영역, 읽기 전용(Read-Only) Data|

----------------------------------------------------------메모리 주소 낮아짐---------------------------------------------------------------->

|스택(Stack)|힙(Heap)|데이터 영역|읽기 전용(Read-Only) Data|
|-|-|-|-|
|지역 변수||전역 변수, 정적 변수|상수와 리터럴|
|지역 변수가 늘어나면 크기가 아래(주소가 낮아지는 방향)로 증가하다가 지역 변수가 파괴되면 다시 위(주소가 높아지는 방향)로 줄어든다.|